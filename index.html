<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Edge Apartemen Kamarku</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background:#f4f4f9; }
    h1,h2 { text-align: center; }
    .container { max-width: 900px; margin: auto; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px,1fr)); gap: 15px; margin-top: 20px; }
    button, a.btn { padding: 10px; border: none; background: #007bff; color: white; border-radius: 6px; cursor: pointer; text-align:center; text-decoration:none; }
    button:hover, a.btn:hover { background: #0056b3; }
    .gallery { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-top: 20px; }
    .gallery img { max-width: 160px; border-radius: 6px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); cursor: pointer; }
    #backBtn { margin-top: 20px; display: block; }

    /* Lightbox */
    #lightbox {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.8); justify-content: center; align-items: center;
      z-index: 9999;
    }
    #lightbox img {
      max-width: 90%; max-height: 80%; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.5);
    }
    #lightbox .close {
      position: absolute; top: 20px; right: 30px; font-size: 30px; color: white; cursor: pointer;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>The Edge Apartemen Kamarku</h1>
  <div id="app"></div>
</div>

<!-- Lightbox -->
<div id="lightbox">
  <span class="close">&times;</span>
  <img id="lightbox-img" src="">
</div>

<script>
  // === Konfigurasi ===
  const baseImageUrl = "https://raw.githubusercontent.com/taniaputriusb-collab/theedge-gallery/main/";

  const gsheetUrl = "https://docs.google.com/spreadsheets/d/1eosqJkqFpnXH7YdHRrKNR6zW9hXKamarku_DataBook_2025/export?format=xlsx";

  const units = {
    "Type 22 Studio": ["1728","1723","1528","1523","723","623","528"],
    "Type 25": ["1520"],
    "Type 36 Studio": ["1929","1910","1903","1735","935"],
    "Type 36 1 Bedroom": ["1939","1856","1832","1811","1809","1256","1110","1108","952","851","817","533"],
    "Type 36 2 Bedroom": ["1908","1733","1606","1508","1250","1219","905","339","472","272","2028"]
  };

  const app = document.getElementById("app");

  // Halaman pilih tipe
  function showTypes() {
    app.innerHTML = "<h2>Pilih Type Unit</h2>";
    const grid = document.createElement("div");
    grid.className = "grid";

    Object.keys(units).forEach(type => {
      const btn = document.createElement("button");
      btn.textContent = type;
      btn.onclick = () => showUnits(type);
      grid.appendChild(btn);
    });

    // Tambah link GDrive
    const link = document.createElement("a");
    link.className = "btn";
    link.href = gsheetUrl;
    link.target = "_blank";
    link.textContent = "üìä Data Reservasi (Google Sheet)";
    grid.appendChild(link);

    app.appendChild(grid);
  }

  // Halaman pilih unit
  function showUnits(type) {
    app.innerHTML = `<h2>${type}</h2>`;
    const grid = document.createElement("div");
    grid.className = "grid";
    units[type].forEach(no => {
      const btn = document.createElement("button");
      btn.textContent = `Unit ${no}`;
      btn.onclick = () => showGallery(no);
      grid.appendChild(btn);
    });
    app.appendChild(grid);

    const back = document.createElement("button");
    back.id = "backBtn"; back.textContent = "‚Üê Kembali";
    back.onclick = showTypes;
    app.appendChild(back);
  }

  // Cek apakah gambar ada
  async function imageExists(url) {
    try {
      const res = await fetch(url, { method: "HEAD" });
      return res.ok;
    } catch (e) {
      return false;
    }
  }

  // Halaman galeri foto unit
  async function showGallery(unitNo) {
    app.innerHTML = `<h2>Galeri Unit ${unitNo}</h2>`;
    const gal = document.createElement("div");
    gal.className = "gallery";

    let photos = [];
    for (let i=1; i<=5; i++) {
      const imgUrl = `${baseImageUrl}${unitNo}-${i}.jpg`;
      if (await imageExists(imgUrl)) {
        const img = document.createElement("img");
        img.src = imgUrl;
        img.onclick = () => openLightbox(imgUrl);
        gal.appendChild(img);
        photos.push(imgUrl);
      }
    }
    if (photos.length === 0) {
      gal.innerHTML = "<p>Tidak ada foto untuk unit ini.</p>";
    }
    app.appendChild(gal);

    // Tombol download semua
    if (photos.length > 0) {
      const dlBtn = document.createElement("button");
      dlBtn.textContent = "Download Semua Foto";
      dlBtn.onclick = () => {
        photos.forEach(url => {
          const a = document.createElement("a");
          a.href = url; a.download = url.split("/").pop();
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
        });
      };
      app.appendChild(dlBtn);
    }

    const back = document.createElement("button");
    back.id = "backBtn"; back.textContent = "‚Üê Kembali";
    back.onclick = () => {
      const type = Object.keys(units).find(t => units[t].includes(unitNo));
      showUnits(type);
    };
    app.appendChild(back);
  }

  // === Lightbox function ===
  const lightbox = document.getElementById("lightbox");
  const lightboxImg = document.getElementById("lightbox-img");
  const closeBtn = document.querySelector("#lightbox .close");

  function openLightbox(url) {
    lightboxImg.src = url;
    lightbox.style.display = "flex";
  }
  closeBtn.onclick = () => { lightbox.style.display = "none"; }
  lightbox.onclick = (e) => { if (e.target === lightbox) lightbox.style.display = "none"; }

  // Load awal
  showTypes();
</script>
</body>
</html>
